<html>
  <head>
    <script src="jquery.js" type="text/javascript" charset="utf-8"></script>
		<style type="text/css" media="screen">
			* { margin:0; padding:0; font-family: sans-serif; }
			.list {
				background: #f1f1f1;
				position: relative;
				margin: 50px 200px;
				padding: 10px;
				width: 50%;
			}
			ul {
				border-top: 1px solid #ccc;
				list-style: none;
			}
			ul li {
				padding: .5em 0;
				border-bottom: 1px solid #ccc;
				/*letter-spacing: 2px;*/
			}
		</style>
		<script type="text/javascript" charset="utf-8">
			$(function(){
				$('.text li').smartTruncate();
				$('.files li').smartTruncate(true);
				$('table td').smartTruncate();
			});
			
			
			$.fn.smartTruncate = function(isFileName){
				return $(this).each(function(i, e){
					var $e = $(e);
					
					// let's get the width of the most common characters
					// in the current font-size 
					var letters = "a b c d e f g h i j k l m n o p q r s t u v w x y z".split(" ");
					var numbers = "1 2 3 4 5 6 7 8 9 0".split(" ");
					var other = "! ยง $ % & / ( ) = ? @ * ' + # - ; , : . < >".split(" ");
					var all = letters
				            .concat([" ", '"', "'"])
					          .concat(numbers)
					          .concat(other)
					          .concat($.map(letters, function(letter){ return letter.toUpperCase(); }));
					var sizes = {};
					var $testWrapper = $('<span/>').css({
						'visibility' : 'hidden', 
						'fontSize'   : $e.css('fontSize'),
						'fontFamily' : $e.css('fontFamily'),
						'fontWeight' : $e.css('fontWeight'),
						'fontStyle'  : $e.css('fontStyle')
					}).appendTo('body');
					$.each(all, function(i, e){ sizes[e] = $testWrapper.text(e).width(); });
					$testWrapper.remove();
					
					// wrap content in a inline element to get exact width
					var $wrapper = $e.wrapInner('<span/>').find('span').css({
						'whiteSpace' : 'nowrap'
					});
					var origText = $wrapper.text();
					var outerWidth = $wrapper.width();
					var tracking = parseInt($e.css('letterSpacing'), 10) || -1;
					
					// keep extension visibile if file name
					var extension = isFileName ? origText.split('.').pop() : "";
					var fileName = isFileName ? (function(t){t=t.split('.');t.pop();return t.join('.');})(origText) : origText;

					// truncate if necessary and append ellipse
					var update = function(){
						var chunks = fileName.split("");
						var diff = $e.width() - outerWidth - 3 * sizes['.'];
						if (diff <= 0) {
							while (diff <= 0) diff = diff + (sizes[chunks.pop()] || sizes['h']) + tracking/2;
							$wrapper.text($.trim(chunks.join(""))+"..."+extension);
						} else $wrapper.text(origText);
					};
					
					// call if window resized
					$(window).bind('resize', function(){ update(); });
					
					// initialize
					update();
				});
			};
		</script>
  </head>
  <body>
    <div class="list text">
    	<ul>
				<li>Lorem ipsum dolor sit amet aliquip &auml;x ea commodo consequat</li>
				<li>Consectetur adipisicing elit, sed do aliquip ex ea commodo consequat</li>
				<li>Eiusmod tempor incididunt aliquip ex ea commodo consequat</li>
				<li>Ut labore et dolore magna aliqua. Ut enim aliquip ex ea commodo consequat</li>
				<li>Ad minim veniam, quis nostrud voluptate velit esse cillum</li>
				<li>Exercitation ullamco laboris nisi ut aliquip aliquip ex ea commodo consequat</li>
			</ul>
    </div>
		<div class="list files">
    	<ul>
				<li>Ruby Programming_Syntax_Classes - Wikibooks, collection of open-content textbooks.pdf</li>
				<li>Tekla_viewer_content_and_learning_material_models_03.key</li>
				<li>Tekla_viewer_content_and_learning_material_models_05.pdf</li>
				<li>startttuppage_khu.pptx</li>
				<li>newsletter-subscription-optin-module.1.1.6.zip</li>
				<li>46573283ef778fddf125d8f6965b6ad0_l.png</li>
			</ul>
    </div>
  </body>
</html>